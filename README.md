# -CyberMiceHackathon
–ì–∏—Ç –ö–æ–º–∞–Ω–¥—ã –ö–∏–±–µ—Ä–ú—ã—à–∏

## Bot pipeline: Parsing -> GigaChat -> Telegram

–î–æ–±–∞–≤–ª–µ–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω: –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –±–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ API (`ai_engine.search_city_services`) –∏ –ø–æ–∏—Å–∫ –≤ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –ø–∞—Ä—Å–∏–Ω–≥–∞ (JSON —Ñ–∞–π–ª—ã –ø–æ–¥ `parsing/`). –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ ‚Äî –±–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ `gu_spb_knowledge` –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ GigaChat.

–í–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏:
- `spb_bot/bot.py` ‚Äî Telegram bot, —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π
- `ai_engine.py` ‚Äî –æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è GigaChat (–≤–∫–ª—é—á–∞—è `ask_agent`, `search_city_services`)
- `parsing/universal_parser.py` ‚Äî –ø–∞—Ä—Å–µ—Ä, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ JSON/CSV
- `tools/test_query.py` ‚Äî —Ç–µ—Å—Ç–æ–≤–∞—è —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞
- `parsing/background_parser.py` ‚Äî –¥–µ–º–æ–Ω –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤—Å–µ—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- `tools/run_background_parser.py` ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å
 - Clicks & button integration: When a user clicks a menu item (e.g., 'üèõÔ∏è –ì–æ—Å—É—Å–ª—É–≥–∏') the bot will
	 - Start a background parse of the relevant site(s) to refresh cached JSON
	 - Call GigaChat (through `ai_engine.ask_agent`) to prepare a short summary using available tools (`search_city_services`, `parse_site_tool`)

–ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ (PowerShell):
```powershell
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—Éenv, –µ—Å–ª–∏ –Ω–∞–¥–æ
python -m pip install -r requirements.txt

# –ó–∞–ø—É—Å—Ç–∏—Ç—å Telegram –±–æ—Ç (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–∫–µ–Ω –≤ spb_bot/bot.py)
python spb_bot/bot.py

# –õ–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç (–±–µ–∑ Telegram, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ai_engine"): 
python tools/test_query.py "–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Å–ø–æ—Ä—Ç" --category documents

## –§–æ–Ω–æ–≤—ã–π –ø–∞—Ä—Å–µ—Ä

–í—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–æ–Ω–æ–≤—ã–π –ø–∞—Ä—Å–µ—Ä –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∫–µ—à–∞ –¥–∞–Ω–Ω—ã—Ö (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

PowerShell –ø—Ä–∏–º–µ—Ä:
```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–æ–Ω–æ–≤—ã–π –ø–∞—Ä—Å–µ—Ä, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∫–∞–∂–¥—ã–µ 3600 —Å–µ–∫ (1 —á–∞—Å)
python tools/run_background_parser.py

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–¥–∏–Ω —Ü–∏–∫–ª –ø–∞—Ä—Å–∏–Ω–≥–∞
$env:PARSER_RUN_ONCE = 'true'; python tools/run_background_parser.py
```

–≠—Ç–∞ —Å–ª—É–∂–±–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `parsing/universal_parser.py` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è JSON/CSV —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –∏ –±–æ—Ç –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–∏ –æ—Ç–≤–µ—Ç–∞—Ö.

### –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–æ–Ω–æ–≤—ã–π –ø–∞—Ä—Å–µ—Ä –∫–∞–∫ —á–∞—Å—Ç—å –±–æ—Ç–∞
–í—ã –º–æ–∂–µ—Ç–µ –≤–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –±—ç–∫–≥—Ä–∞—É–Ω–¥-—Å–µ—Ä–≤–∏—Å–∞ –ø—Ä—è–º–æ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞:
```powershell
$env:START_PARSER_BACKGROUND = 'true'
# –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ PARSER_INTERVAL_SECONDS (—Å–µ–∫.)
python spb_bot/bot.py
```

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Å—Ç—É—é keyword-based –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—É—é –¥–µ—Ç–µ–∫—Ü–∏—é (`ai_engine.detect_category`) —á—Ç–æ–±—ã –≤—ã–±–∏—Ä–∞—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ API –¥–ª—è –ø–æ–∏—Å–∫–∞. –≠—Ç–æ —É–º–µ–Ω—å—à–∞–µ—Ç —á–∏—Å–ª–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API –∏ –ø–æ–≤—ã—à–∞–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞.

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–æ–π –¥–µ—Ç–µ–∫—Ü–∏–∏ –∏ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞

```powershell
python tools/test_detect_and_parse.py "–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Å–ø–æ—Ä—Ç"
```


```

